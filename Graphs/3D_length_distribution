from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
import numpy as np


fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

colors = ['r', 'g', 'b', 'y', 'c']
yticks = [0, 1, 2, 3, 4]
#  average numbers from technical replicates of lengths fro each passage
lengths = [[3355, 10300, 6766, 32238, 30183, 26910, 246444, 44610, 94212, 131326, 154470, 218821, 328997, 396292, 613629, 753930, 610509, 715401, 759758, 818739, 1880556, 1452689, 1434089, 5168229, 769393, 586928, 546499, 538710, 562316, 415475, 429812, 526046, 406283, 381443, 322857, 329564, 264480, 260449, 216386, 196857, 160305, 139908, 114707, 88766, 82223, 70535, 63026, 490290],
          [452, 2623, 3459, 25355, 7404, 15851, 68103, 40912, 76722, 141363, 209279, 237415, 331350, 381078, 491202, 626942, 549882, 609938, 672669, 679562, 1692256, 1667801, 1159067, 3750330, 667664, 534656, 522415, 526064, 497116, 440019, 483285, 601419, 815080, 615129, 489661, 358892, 288254, 268614, 170381, 140180, 134170, 70464, 50106, 31766, 25164, 20648, 18008, 221679],
          [1114, 5812, 6104, 36158, 9550, 19919, 111784, 54388, 102059, 169878, 290844, 277114, 383340, 395983, 571854, 791848, 514179, 541515, 618284, 667376, 2795367, 2544000, 1372779, 6062558, 590809, 352864, 341888, 339230, 333428, 284064, 351873, 524497, 853546, 576405, 373904, 247222, 185873, 190301, 102317, 88237, 105390, 38878, 26699, 16702, 14128, 11311, 11293, 228046],
          [684, 5039, 3164, 12195, 19015, 15601, 126813, 15913, 21559, 44299, 33247, 47072, 109198, 69047, 128980, 154433, 121163, 146152, 289499, 421042, 4108664, 2384966, 1574936, 9772438, 421364, 102482, 127173, 211844, 573391, 42944, 78095, 264383, 124201, 244545, 68985, 114244, 28488, 68019, 34863, 23126, 15580, 17057, 9165, 8962, 7735, 7723, 8024, 289404],
          [1070, 4275, 3376, 17379, 28089, 22887, 154237, 33196, 61799, 112402, 122699, 197732, 313783, 366569, 541317, 698591, 572222, 698330, 744909, 845665, 1844724, 1454165, 1649419, 4592020, 838362, 697820, 671887, 666153, 724396, 568249, 556292, 667326, 525282, 427453, 351435, 354470, 237062, 226224, 167562, 140133, 97754, 82731, 57394, 37848, 30746, 23445, 20232, 282070]
          ]

for c, k in zip(colors, yticks):
    xs = np.arange(48)
    ys = lengths[k]

    # You can provide either a single color or an array with the same length as
    # xs and ys. To demonstrate this, we color the first bar of each set cyan.
    cs = [c] * len(xs)
    # cs[0] = 'c'

    # Plot the bar graph given by xs and ys on the plane y=k with 80% opacity.
    ax.bar(xs, ys, zs=k, zdir='y', color=cs, alpha=0.8)

ax.set_xlabel('smRNA langth')
ax.set_ylabel('          Plant   P1   P3   P8   REG')  # y axis label as one string, it sufficient
ax.set_zlabel('count')

# On the y axis let's only label the discrete values that we have data for.
ax.set_yticks(yticks)

plt.show()
